<section [@routerTransition]>
    <section class="content-header">
        <div class="container-fluid">
            <div class="row">
                <h2> Fisa cont
                    <button class="btn btn-danger" title="Inchide fereastra" (click)="closeTab()"><i class="fas fa-times"></i></button>
                </h2>
            </div>
        </div>
    </section>
    <section class="content px-2">
        <div class="container-fluid">
            <div class="body">
                <form id="init" name="init"
                       [busy]="isLoading">
                    <div class="row">
                        <div class="col-lg-1">
                            <label for="accountId" class="col-form-label">Cont</label>
                        </div>
                        <div class="col-lg-3">
                            <mat-form-field style="width: 100%;">
                                <input type="text" matInput id="accountId"
                                       name="accountId"
                                       [(ngModel)]="accountSheet.accountId"
                                       (input)="searchAccountByInput($event)"
                                       required
                                       [matAutocomplete]="auto"
                                       #accountId="ngModel" />
                                <mat-autocomplete #auto="matAutocomplete" [displayWith]="getAccountName.bind(this)">
                                    <mat-select *ngFor="let item of accountList">
                                        <mat-option (click)="selectedAccount(item.id, item.name )" [ngValue]="item.id">
                                            {{ item.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-autocomplete>
                            </mat-form-field>
                        </div>
                        <div class="col-lg-1">
                            <label for="startDate">Perioada</label>
                        </div>
                        <div class="col-lg-2">
                            <mat-form-field style="width: 100%">
                                <input matInput
                                       id="startDate"
                                       name="startDate"
                                       [matDatepicker]="searchStartDatePicker"
                                       [(ngModel)]="accountSheet.startDate"
                                       #startDate="ngModel">
                                <mat-datepicker-toggle matSuffix [for]="searchStartDatePicker"></mat-datepicker-toggle>
                                <mat-datepicker #searchStartDatePicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-lg-2">
                            <mat-form-field style="width: 100%">
                                <input matInput
                                       id="endDate"
                                       name="endDate"
                                       [matDatepicker]="searchEndDatePicker"
                                       [(ngModel)]="accountSheet.endDate"
                                       #endDate="ngModel">
                                <mat-datepicker-toggle matSuffix [for]="searchEndDatePicker"></mat-datepicker-toggle>
                                <mat-datepicker #searchEndDatePicker></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-lg-1">
                            <label for="currency" class="col-form-label">Moneda</label>
                        </div>
                        <div class="col-lg-1">
                            <select id="currency" name="currency" [(ngModel)]="accountSheet.currencyId" #currencyId="ngModel" class="form-control" [disabled]="accountSheet.accountId == null" (ngModelChange)="fisaContView()">
                                <option *ngFor="let item of currencies.getCurrency" [ngValue]="item.id">{{ item.currencyName }}</option>
                            </select>
                        </div>
                        <div class="col-lg-1">
                            <button (click)="fisaContView()" class="btn btn-info"><i class="fas fa-search"></i></button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-1">
                            <label for="corespAccountId">Cont Coresp</label>
                        </div>
                        <div class="col-lg-2">
                            <select id="corespAccountId" name="corespAccountId" class="form-control" [disabled]="accountSheet.accountId == null" [(ngModel)]="accountSheet.corespAccountId" #corespAccountId="ngModel" (change)="fisaContChangeCoresp()">
                                <option [ngValue]="null">Toate</option>
                                <option *ngFor="let item of accountSheet.corespAccountList" [ngValue]="item.id">{{ item.name }}</option>
                            </select>
                        </div>
                    </div>
                </form>
                <hr />

                <form id="accountSheet" name="accountSheet" *ngIf="accountSheet.showDetails">
                    <div class="row">
                        <div class="col-lg-12">
                            <button (click)="showReport()" class="btn btn-info">Raport</button>
                        </div>
                        <br />
                        <div class="col-lg-12">
                            <table class="table" style="height: 100px;">
                                <tr>
                                    <th scope="col" colspan="4"></th>
                                    <th scope="col" colspan="3">Sold inceputul anului</th>
                                    <th scope="col" class="align-right">{{ accountSheet.soldInitial | number:'1.2' }}</th>
                                    <th scope="col">{{ accountSheet.soldInitialType }}</th>
                                </tr>
                                <tr>
                                    <th scope="col" colspan="4"></th>
                                    <th scope="col" colspan="1">Rulaje precedente</th>
                                    <th scope="col" class="align-right">{{ accountSheet.totalPrecDebit | number:'1.2' }}</th>
                                    <th scope="col" class="align-right">{{ accountSheet.totalPrecCredit | number:'1.2' }}</th>
                                    <th scope="col" class="align-right">{{ accountSheet.soldPrecedent | number:'1.2' }}</th>
                                    <th scope="col">{{ accountSheet.soldPrecedentType }}</th>

                                </tr>
                                <thead>
                                    <tr>
                                        <th scope="col">Data</th>
                                        <th scope="col">Tip doc</th>
                                        <th scope="col">Nr.doc / Data doc.</th>
                                        <th scope="col">Explicatie</th>
                                        <th scope="col">Cont corespondent</th>
                                        <th scope="col" class="align-right">Debit</th>
                                        <th scope="col" class="align-right">Credit</th>
                                        <th scope="col" class="align-right">Sold</th>
                                        <th scope="col">D/C</th>
                                    </tr>
                                </thead>
                                <tbody *ngFor="let detail of accountSheet?.operationsDetailSelection">
                                    <tr>
                                        <td>{{detail.operationDate | date: 'dd.MM.yyyy' }}</td>
                                        <td>{{detail.documentTypeShortName}}</td>
                                        <td>{{detail.documentNumber }} / {{detail.documentDate | date: 'dd.MM.yyyy' }}</td>
                                        <td>{{detail.operationDetailsObservations}}</td>
                                        <td>{{detail.corespAccountSymbol}}</td>
                                        <td class="align-right">{{ detail.debitValue | number:'1.2' }}</td>
                                        <td class="align-right">{{ detail.creditValue | number:'1.2' }}</td>
                                        <td class="align-right">{{ detail.sold | number:'1.2'}}</td>
                                        <td>{{ detail.valueType}}</td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th scope="col" colspan="4"></th>
                                        <th scope="col">Total Rulaje in perioada</th>
                                        <th scope="col" class="align-right">{{ accountSheet.totalDebit | number:'1.2' }}</th>
                                        <th scope="col" class="align-right">{{ accountSheet.totalCredit | number:'1.2' }}</th>
                                        <th scope="col" class="align-right"></th>
                                        <th scope="col">{{ accountSheet.soldFinalType }}</th>
                                    </tr>
                                    <tr>
                                        <th scope="col" colspan="4"></th>
                                        <th scope="col">Total Rulaje</th>
                                        <th scope="col" class="align-right">{{ accountSheet.totalDebit + accountSheet.totalPrecDebit | number:'1.2' }}</th>
                                        <th scope="col" class="align-right">{{ accountSheet.totalCredit + accountSheet.totalPrecCredit | number:'1.2' }}</th>
                                        <th scope="col" class="align-right">{{ accountSheet.soldFinal | number:'1.2' }}</th>
                                        <th scope="col">{{ accountSheet.soldFinalType }}</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>
</section>
